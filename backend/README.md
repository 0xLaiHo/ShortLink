# ShortLink - URL Shortener Service

åŸºäº Go è¯­è¨€å®ç°çš„çŸ­é“¾æ¥ç”ŸæˆæœåŠ¡ï¼Œé‡‡ç”¨æ¸…æ™°çš„åˆ†å±‚æ¶æ„è®¾è®¡ã€‚

## ğŸ“ é¡¹ç›®ç»“æ„

```
backend/
â”œâ”€â”€ main.go                          # åº”ç”¨ç¨‹åºå…¥å£
â”œâ”€â”€ go.mod                           # Go æ¨¡å—å®šä¹‰
â”œâ”€â”€ go.sum                           # ä¾èµ–é”å®š
â”œâ”€â”€ Dockerfile                       # Docker æ„å»ºé…ç½®
â””â”€â”€ internal/                        # å†…éƒ¨åŒ…ï¼ˆç§æœ‰ï¼‰
    â”œâ”€â”€ config/                      # é…ç½®å±‚
    â”‚   â””â”€â”€ config.go                # ç¯å¢ƒå˜é‡é…ç½®åŠ è½½
    â”œâ”€â”€ models/                      # æ•°æ®æ¨¡å‹å±‚
    â”‚   â””â”€â”€ link.go                  # Link å®ä½“å’Œ DTO
    â”œâ”€â”€ repository/                  # æ•°æ®è®¿é—®å±‚
    â”‚   â”œâ”€â”€ repository.go            # Repository æ¥å£å®šä¹‰
    â”‚   â”œâ”€â”€ redis.go                 # Redis å®ç°
    â”‚   â””â”€â”€ errors.go                # è‡ªå®šä¹‰é”™è¯¯
    â”œâ”€â”€ service/                     # ä¸šåŠ¡é€»è¾‘å±‚
    â”‚   â””â”€â”€ link_service.go          # çŸ­é“¾æ¥ä¸šåŠ¡æœåŠ¡
    â”œâ”€â”€ handler/                     # HTTP å¤„ç†å±‚
    â”‚   â””â”€â”€ link_handler.go          # API è¯·æ±‚å¤„ç†å™¨
    â”œâ”€â”€ middleware/                  # ä¸­é—´ä»¶
    â”‚   â””â”€â”€ cors.go                  # CORS ä¸­é—´ä»¶
    â””â”€â”€ router/                      # è·¯ç”±å±‚
        â””â”€â”€ router.go                # è·¯ç”±é…ç½®
```

## ğŸ—ï¸ æ¶æ„è®¾è®¡

é‡‡ç”¨ç»å…¸çš„åˆ†å±‚æ¶æ„ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   HTTP Request                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Middleware (CORS, etc.)            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Router (è·¯ç”±å±‚)                   â”‚
â”‚            å®šä¹‰ API è·¯ç”±å’Œç«¯ç‚¹                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Handler (å¤„ç†å±‚)                   â”‚
â”‚         è§£æè¯·æ±‚ã€éªŒè¯ã€è¿”å›å“åº”                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               Service (æœåŠ¡å±‚)                   â”‚
â”‚             æ ¸å¿ƒä¸šåŠ¡é€»è¾‘                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚             Repository (æ•°æ®å±‚)                  â”‚
â”‚           æ•°æ®å­˜å‚¨æŠ½è±¡æ¥å£                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                Redis / å…¶ä»–å­˜å‚¨                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### ä½¿ç”¨ Docker Composeï¼ˆæ¨èï¼‰

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
docker compose up

# åå°è¿è¡Œ
docker compose up -d

# åœæ­¢æœåŠ¡
docker compose down
```

æœåŠ¡å¯åŠ¨åè®¿é—®ï¼š`http://localhost:8080`

### æœ¬åœ°å¼€å‘

```bash
# 1. å¯åŠ¨ Redis
docker run -d --name redis -p 6379:6379 redis:7-alpine

# 2. è¿›å…¥ backend ç›®å½•
cd backend

# 3. ä¸‹è½½ä¾èµ–
go mod tidy

# 4. è¿è¡ŒæœåŠ¡
go run main.go
```

## ğŸ”§ ç¯å¢ƒå˜é‡é…ç½®

| å˜é‡å | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|--------|------|
| `SERVER_PORT` | `8080` | æœåŠ¡ç«¯å£ |
| `BASE_URL` | `http://localhost:8080` | çŸ­é“¾æ¥åŸºç¡€ URL |
| `REDIS_ADDR` | `localhost:6379` | Redis åœ°å€ |
| `REDIS_PASSWORD` | `""` | Redis å¯†ç  |
| `GIN_MODE` | `debug` | Gin è¿è¡Œæ¨¡å¼ (`debug`/`release`) |

## ğŸ“¡ API æ¥å£

### åˆ›å»ºçŸ­é“¾æ¥

```bash
POST /api/shorten
Content-Type: application/json

{
  "url": "https://github.com/example/repo"
}
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "short_code": "abc123",
  "short_url": "http://localhost:8080/abc123",
  "original_url": "https://github.com/example/repo"
}
```

### è®¿é—®çŸ­é“¾æ¥ï¼ˆé‡å®šå‘ï¼‰

```bash
GET /:code

# ç¤ºä¾‹
curl -L http://localhost:8080/abc123
```

### è·å–é“¾æ¥ä¿¡æ¯

```bash
GET /api/info/:code
```

**å“åº”ç¤ºä¾‹ï¼š**
```json
{
  "short_code": "abc123",
  "original_url": "https://github.com/example/repo",
  "created_at": "2026-01-19T10:30:00Z",
  "clicks": 42
}
```

### è·å–æ‰€æœ‰é“¾æ¥

```bash
GET /api/links
```

### åˆ é™¤é“¾æ¥

```bash
DELETE /api/links/:code
```

### å¥åº·æ£€æŸ¥

```bash
GET /health
```

## ğŸ§© æ‰©å±•æŒ‡å—

### æ·»åŠ æ–°çš„å­˜å‚¨åç«¯

1. åœ¨ `internal/repository/` ä¸‹åˆ›å»ºæ–°æ–‡ä»¶ï¼ˆå¦‚ `mysql.go`ï¼‰
2. å®ç° `LinkRepository` æ¥å£
3. åœ¨ `main.go` ä¸­æ›¿æ¢ repository åˆå§‹åŒ–é€»è¾‘

```go
// ç¤ºä¾‹ï¼šåˆ‡æ¢åˆ° MySQL
type MySQLRepository struct {
    db *sql.DB
}

func (r *MySQLRepository) Save(ctx context.Context, link *models.Link) error {
    // å®ç°ä¿å­˜é€»è¾‘
}
// ... å®ç°å…¶ä»–æ¥å£æ–¹æ³•
```

### æ·»åŠ æ–°çš„ API ç«¯ç‚¹

1. åœ¨ `internal/service/link_service.go` ä¸­æ·»åŠ ä¸šåŠ¡æ–¹æ³•
2. åœ¨ `internal/handler/link_handler.go` ä¸­æ·»åŠ å¤„ç†å‡½æ•°
3. åœ¨ `internal/router/router.go` ä¸­æ³¨å†Œè·¯ç”±

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **Go 1.23** - ç¼–ç¨‹è¯­è¨€
- **Gin** - Web æ¡†æ¶
- **Redis** - æ•°æ®å­˜å‚¨
- **Docker** - å®¹å™¨åŒ–éƒ¨ç½²

## ğŸ“ License

MIT
